<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中国世界地质遗迹公园总览</title>
    <script type="text/javascript">
        window._AMapSecurityConfig = {
            securityJsCode:'368f9c365130ab5332d436503d0d7e4c',
        }
</script>
<script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=c75cfe9e7045c70595d8dc38941b0e64"
></script>

<script src="./lianjie3.java"></script>



<style>
    html,
    body,
    #container{
          width: 100%;
          height: 100%;
    }

</style>

</head>
<body>
    <!-- <h1>MySQL 查询结果</h1>
    <ul id="result"></ul> -->

    <div id="container"></div>
   
   <script type="module">
        var map = new AMap.Map("container", {
    mapStyle: "amap://styles/darkblue", //设置地图的显示样式
    });


    // async function fetchData() {
    //   const response = await fetch('/query');
    //   const data = await response.json();
    //   const resultElement = document.getElementById('result');
    //   data.forEach(row => {
    //     const li = document.createElement('li');
    //     li.textContent = `Name: ${row.name}, lng: ${row.lng}, lat: ${row.lat}`;
    //     resultElement.appendChild(li);
    //   });
    // }

    // fetchData().catch(error => {
    //   console.error('查询失败:', error);
    // });


   	//点标记与信息窗体的创建与添加
    var infoWindow = new AMap.InfoWindow({
    offset: new AMap.Pixel(0, -30)
    });

    for (var i = 0, marker; i < lnglats.length; i++) {
        var marker = new AMap.Marker({
            position: lnglats[i],
            name:name_park[i],
            map: map
        });
        marker.content = '<div><h3>名称：'+name_park[i]+'</h3></div>';
        marker.content += '<div>经度：'+lnglats[i][0]+'</div>';
        marker.content += '<div>纬度：'+lnglats[i][1]+'</div>';
        marker.on('mouseover', infoOpen);
		//注释后打开地图时默认关闭信息窗体
		marker.on('mouseout', infoClose);
		marker.on('click', newMAp);
    }
    function newMAp(e) {
		map.setZoomAndCenter(15, e.target.getPosition());
		
		var infoWindow = new AMap.InfoWindow({offset: new AMap.Pixel(0, -30)});
		infoWindow.setContent(e.target.content);
		infoWindow.open(map, e.target.getPosition());	
	}
    function infoClose(e) {
		infoWindow.close(map, e.target.getPosition());
	}
    function infoOpen(e) {
        infoWindow.setContent(e.target.content);
        infoWindow.open(map, e.target.getPosition());
    }
    		map.setFitView();
 	function closeInfoWindow() {
        map.clearInfoWindow();
    };

    </script> 
    

    
</body>
</html>